:: StoryTitle
Memory Loss: Find Your Way Back


:: StoryData
{
	"ifid": "DC4F9919-114F-42D0-AD6B-6D66F013AD8C",
	"format": "Harlowe",
	"format-version": "3.3.3",
	"start": "initMain",
	"zoom": 1
}


:: Story Stylesheet [stylesheet]
/* -- Twine overrides -- */

/* Redo and undo button */
tw-icon {
  color: #ad00d8;
}

/* TODO: NUR Bei nicht StoryMode  playingStory == false
tw-sidebar {
  display: none;
}

tw-icon.undo {
  display: none;
}

tw-icon.redo {
  display: none;
}*/


tw-link {
  color: #4B0872;
}
tw-link:hover {
  color: #B200DD;
}

tw-story {
  background-image: url('src/img/general/background/background_landscape.svg');
  background-size: cover;
  background-repeat: no-repeat;
  background-attachment: fixed;
}

#resume-btn {
  background-color: var(--purple) !important;
}

/* -- General CSS -- */

/* Font */
@import url("https://fonts.cdnfonts.com/css/ocr-a-extended");

/* Font colors */
:root {
  --font_yellow: #F79E00;
  --font_grey: #9B9B9B;
}

/* Background colors */
:root {
  --purple: #B200DD;
  --purple_dark: #4B0872;
  --blue: #4316A5;
  --blue_dark: #250777;
  --grey1: #1E1E1E;
  --grey2: #161616;
  --grey3: #141414;
}

.removeUndoReod {
	display:none;
  	visibility: hidden;
}

.color_purple {
  background-color: var(--purple) !important;
}

.hint-btn-background {
  background: url(src/img/general/ctf/hint.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: none;
}

.success-btn-background {
  background: url(src/img/general/ctf/success.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: none;
}

.code-btn-background {
  background: url(src/img/general/ctf/code.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: none;
}

.home-btn-background {
  background: url(src/img/general/ctf/home.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: none;
}

.help-btn-background {
  background: url(src/img/general/ctf/help.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: none;
}

.reload-btn-background {
  background: url(src/img/general/ctf/reload.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: none;
}

#home-btn{
  background: url(src/img/general/ctf/home.svg);
  height: 3rem;
  width: 3rem;
  background-size: cover;
  border: 0px;
  filter: grayscale(100%);
}


:: Story JavaScript [script]
window.setup = window.setup || {};
$(document.head).append("<link rel='icon' href='src/img/main/usb_stick.svg'>");


/* # Mainpage */

setup.main = function() {
	document.getElementById("startButton").addEventListener("click", eventOnClickHandlerMain);
	document.getElementById("restartButton").addEventListener("click", eventOnClickHandlerMainRestart);
}

function eventOnClickHandlerMainRestart(event) {
	 Harlowe.storage.clear("last_passage");
	 eventOnClickHandlerMain();
}

function eventOnClickHandlerMain(event) {
  // Access DOM element object
  const rotated = document.getElementById("demo");

  // Rotate element by 90 degrees clockwise
  rotated.style.WebkitTransitionDuration='1s';
  rotated.style.webkitTransform = 'translate(250px, -100px) rotate(90deg)';

  /* Redirect to Story */
  setTimeout(() => {
    Harlowe.goto("setStory");
  }, 1500);
}

/* # Mainpage End */


/* # CTF 1 Start */

setup.ctf1 = function() {
	document.getElementById("login-btn").addEventListener("click", eventOnClickHandler);
}

function eventOnClickHandler(event) {
  var user = btoa(document.getElementById("user").value.replace(/=/g, ""));
  var pass = btoa(document.getElementById("password").value.replace(/=/g, ""));
  
  if ("d3d3LWFkbWlu" !== user && "cHV6emVsUGllY2V7RGhGcE1YSHlYNX0=" !== pass) {
    alert("Incorrect Username or Password");
	  return
  } else {
  	alert(`Correct Username and Password! \nYour flag is ${atob(pass)}.`)

	  /* Redirect to Story or Ctf Overview */
	  Harlowe.goto("CTF1end");
    return
  }
}

/* # CTF 1 End */


/* Global Start */

//disable back btn if playing in ctf mode
setup.all = function () {
	var mode =  Harlowe.variable("$playingStory")

  if (!mode){
    var btns = document.querySelectorAll('tw-icon'); 
    for (let b of btns) {
      b.classList.add("removeUndoReod");
    }
  }
}

setup.story = function () {
var mode =  Harlowe.variable("$playingStory")
	if (mode){
		var sidebar = document.querySelector("tw-sidebar");
		var btn = document.createElement('button');
		btn.onclick = function(){
			var passage = Harlowe.passage()
			Harlowe.storage.save("last_passage", passage)
			Harlowe.goto("MainPage")
    };

		btn.id = "home-btn"
		sidebar.appendChild(btn);
	}
}

window.addEventListener("message", function(event) {
  if (event.data == "js_inserted_ctf4") {
    ctf4_updateURI(event.data);
    ctf4_levelSucceed();
    return;
  }
  
  if (event.data == "js_inserted_ctf5") {
    ctf5_updateURI(event.data);
    ctf5_levelSucceed();
    return;
  }
  
  if (event.data.startsWith("ctf6_url_")) {
    ctf6_updateURI(event.data);
	  console.log("success: " + event.data)
    return;
  }
  
  if (event.data == "js_inserted_ctf6") {
    ctf6_updateURI(event.data);
    ctf6_levelSucceed();
    return;
  }
}, false);

/* Global End */


/* # CTF 4 Start */

setup.ctf4_updateFrame = function (frameNum, url) {
  if (!url) {
  	var urlbar = document.getElementById('input'); 
  	var url = urlbar.value;
  };
    
  // Make sure that the URL points to the frame of the current level
  var frameLink = document.createElement('a');
  frameLink.href = url;

  if (!url.startsWith('https://twine.ctf/ctf4.html') || !url.endsWith) {
    alert("Sorry, I can't open this URL in a frame.");
    urlbar.value = "https://twine.ctf/ctf4.html";
    var frame = document.querySelector('iframe');
    frame.src = "src/static/ctf4/s.html";

   	//frame.contentWindow.postMessage(url, "*"); /* TODO: When code is not used then delete it */
    return
  } else {
    var arg = url.replace("https://twine.ctf/ctf4.html", "");
    var frame = document.querySelector('iframe');
    frame.src = "src/static/ctf4/s.html" + arg;
    //frame.contentWindow.postMessage(url, "*"); /* TODO: When code is not used then delete it */
  }
};

function ctf4_updateURI(value) {
  var urlbar = document.getElementById('input');
  urlbar.value = "https://twine.ctf/ctf4.html";
}

function ctf4_levelSucceed() {
	alert("XSS Success");
  Harlowe.goto("CTF4_end");
}

/* # CTF 4 End */


/* # CTF 5 Start */

setup.ctf5_updateFrame = function (frameNum, url) { 
  if (!url) {
  	var urlbar = document.getElementById('input'); 
  	var url = urlbar.value;
  };
    
  // Make sure that the URL points to the frame of the current level
  var frameLink = document.createElement('a');
  frameLink.href = url;

  if (!url.startsWith('https://twine.ctf/ctf5.html') || !url.endsWith) {
    alert("Sorry, I can't open this URL in a frame.");
    urlbar.value = "https://twine.ctf/ctf5.html";
    var frame = document.querySelector('iframe');
    frame.src = "src/static/ctf5/s.html";

   	//frame.contentWindow.postMessage(url, "*"); /* TODO: When code is not used then delete it */
    return
  } else {
    var arg = url.replace("https://twine.ctf/ctf5.html", "");
    var frame = document.querySelector('iframe');
    frame.src = "src/static/ctf5/t.html" + arg;
    //frame.contentWindow.postMessage(url, "*"); /* TODO: When code is not used then delete it */
  }
};

function ctf5_updateURI(value) {
  var urlbar = document.getElementById('input');
  urlbar.value = "https://twine.ctf/ctf5.html";
}

function ctf5_levelSucceed() {
  Harlowe.goto("CTF5_end");
}

/* # CTF 5 End */


/* # CTF 6 Start */
setup.ctf6_reset = function(){
  window.localStorage.setItem('picID', "1");	
}

setup.ctf6_updateFrame = function (frameNum, url) { 
  if (!url) {
  	var urlbar = document.getElementById('input'); 
  	var url = urlbar.value;
  };
    
  // Make sure that the URL points to the frame of the current level
  var frameLink = document.createElement('a');
  frameLink.href = url;

  if (!url.startsWith('https://twine.ctf/ctf6.html')) {
    alert("Sorry, I can't open this URL in a frame.");
    urlbar.value = "https://twine.ctf/ctf6.html";
    var frame = document.querySelector('iframe');
    frame.src = "src/static/ctf6/u.html";
    return
  } else {
    var arg = url.replace("https://twine.ctf/ctf6.html#", "");
    var frame = document.querySelector('iframe');
    frame.src = "src/static/ctf6/u.html"; 
    console.log("arg:" + arg)
    
    /* frame.contentWindow.location.reload(true); In google Chrome “blocked a frame with origin "null" from accessing a cross-origin frame */ /* TODO: When code is not used then delete it */
    frame.contentWindow.postMessage(arg,"*")
  }
};

function ctf6_updateURI(value) {
  var urlbar = document.getElementById('input');
  var picID = value.replaceAll("ctf6_url_","");
  urlbar.value = "https://twine.ctf/ctf6.html#" + picID;
}

function ctf6_levelSucceed() {
  Harlowe.goto("CTF6_end");
}

setup.ctf6_showCode = function() {
  var codeBox = document.getElementById('code'); 
  codeBox.innerHTML = Harlowe.variable("$ctf6_code")
}

/* # CTF 6 End */

/* # CTF 9 Start */
setup.ctf9_showCode = function() {
  var codeBox2 = document.getElementById('code'); 
  codeBox2.innerHTML = Harlowe.variable("$ctf9_code")
}
/* # CTF 9 End */

/* Marko API */
// Harlowe Macro Framework, by Chapel; version 1.0.2
;!function(){"use strict";var r={major:1,minor:0,patch:2},e=[r.major,r.minor,r.patch].join(".");r.semantic=e,r=Object.freeze(r);var t=$("tw-storydata"),a=Object.freeze({name:t.attr("name"),ifid:t.attr("ifid")}),n=t.attr("format-version"),o=n.split("."),i=Object.freeze({major:o[0],minor:o[1],patch:o[2],semantic:n});window.Harlowe=window.Harlowe||{},window.Harlowe=Object.assign(window.Harlowe,{framework:r,API_ACCESS:Object.freeze({MACROS:require("macros"),STATE:require("state"),CHANGER:require("datatypes/changercommand"),ENGINE:require("engine")}),engine:i,story:a})}(),function(){"use strict";function e(r){return"number"==typeof r||"boolean"==typeof r||"string"==typeof r||null===r||Array.isArray(r)&&r.every(e)||r instanceof Set&&Array.from(r).every(e)||r instanceof Map&&Array.from(r.values()).every(e)||_changer.isPrototypeOf(r)}window.Harlowe=Object.assign(window.Harlowe,{helpers:{isSerialisable:e,isSerializable:e,arrayify:function(r,e){if(r){var t=[].slice.call(r);return void 0!==e&&(t=t.slice(e)),t}},getPassageData:function(r){var e=$('tw-passagedata[name="'+r+'"]');if(e[0])return e}}})}(),function(){"use strict";var n=window.localStorage||!1,o=Harlowe.story.ifid+"-tw-storage";function r(){try{if(!n)throw new Error("storage is inaccessible");n.setItem(o,JSON.stringify({ifid:Harlowe.story.ifid}))}catch(r){console.warn(r)}}function i(r){try{var e;if(n)return e=JSON.parse(n.getItem(o)),r&&r&&"string"==typeof r?e[r]:e;throw new Error("storage is inaccessible")}catch(r){console.warn(r)}}null==i()&&r(),Harlowe.storage={clear:r,save:function(r,e){try{if(!r||"string"!=typeof r)throw new TypeError("cannot store values without a valid storage key");if(void 0===e)throw new TypeError("cannot store undefined values");var t={};if(t[r]=e,!n)throw new Error("storage is inaccessible");var a=i();Object.assign(a,t),n.setItem(o,JSON.stringify(a))}catch(r){console.warn(r)}},load:i,remove:function(r){try{if(!r||"string"!=typeof r)throw new TypeError("cannot store values without a valid storage key");if(!n)throw new Error("storage is inaccessible");var e=i();e.hasOwnProperty(r)&&(delete e[r],n.setItem(o,JSON.stringify(e)))}catch(r){console.warn(r)}}}}(),function(){"use strict";function a(r,e,t){if(!(this instanceof a))return new a(r,e,t);this.name=r||"unknown",this.args=e||[],this.data=t||{},this.type=t&&t.type||"basic",this.fn=t&&t.fn||"handler","changer"===this.type&&("handler"===this.fn?this.instance=t&&t.instance||null:this.descriptor=t&&t.descriptor||null)}a.create=function(r,e,t){if(!r||"string"!=typeof r||!r.trim())throw new TypeError("Invalid macro name.");return e&&e instanceof Array||(e=[]),t&&"object"==typeof t||(t={type:"basic",fn:"handler"}),new a(r,e,t)},Object.assign(a.prototype,{clone:function(){return a.create(this.name,this.args,this.data)},syntax:function(){return"("+this.name+":)"},error:function(r,e){var t="Error in the "+this.syntax()+" macro: "+r;return e&&alert(t),console.warn("HARLOWE CUSTOM MACRO ERROR -> ",t),new Error(r)},typeCheck:function(r){r&&r instanceof Array||(r=Harlowe.helpers.arrayify(arguments));var n=this,o=[];if(r.forEach(function(r,e){var t=e+1,a=[];"string"==typeof r&&("any"===(a=r.includes("|")?r.split("|").map(function(r){return r.trim().toLowerCase()}):[r.trim().toLowerCase()])[0]||a.some(function(r){return typeof n.args[e]===r})||o.push("argument "+t+" should be a(n) "+a.join(" or ")))}),o.length)return n.error(o.join("; "))}}),window.Harlowe=Object.assign(window.Harlowe,{MacroContext:a})}(),function(){"use strict";var c=Harlowe.API_ACCESS.MACROS,l=Harlowe.API_ACCESS.CHANGER;window.Harlowe=Object.assign(window.Harlowe||{},{macro:function(r,e,t){if(!r||"string"!=typeof r||!r.trim())throw new TypeError("Invalid macro name.");if(!e||"function"!=typeof e)throw new TypeError("Invalid macro handler.");var a,n,o,i,s;t&&"function"==typeof t?(o=r,i=e,s=t,c.addChanger(o,function(){var r=Harlowe.helpers.arrayify(arguments,1),e=l.create(o,r),t=Harlowe.MacroContext.create(o,r,{type:"changer",fn:"handler",instance:e});return i.apply(t,r),e},function(){var r=Harlowe.helpers.arrayify(arguments),e=r.shift(),t=Harlowe.MacroContext.create(o,r,{type:"changer",fn:"changer",descriptor:e});s.apply(t,r)},c.TypeSignature.zeroOrMore(c.TypeSignature.Any))):(a=r,n=e,c.add(a,function(){var r=Harlowe.helpers.arrayify(arguments,1),e=Harlowe.MacroContext.create(a,r,{type:"basic",fn:"handler"}),t=n.apply(e,r);return null==t?"":t},c.TypeSignature.zeroOrMore(c.TypeSignature.Any)))}})}(),function(){"use strict";var t=Harlowe.API_ACCESS.STATE,e=Harlowe.API_ACCESS.ENGINE;function a(){return t.passage}window.Harlowe=Object.assign(window.Harlowe||{},{passage:a,tags:function(r){r=r||a();try{var e=Harlowe.helpers.getPassageData(r).attr("tags");return e?e.split(" "):[]}catch(r){return console.warn(r.message),[]}},goto:function(r){return e.goToPassage(r)},variable:function(r,e){if("$"!==r[0])throw new Error('cannot access variable "'+r+'"');if(r=r.substr(1),void 0!==e){if(!Harlowe.helpers.isSerialisable(e))throw new Error('The value passed to variable "'+r+'" cannot be serialized.');t.variables[r]=e}return t.variables[r]},visited:function(r){return t.passageNameVisited(r||a())},hasVisited:function(r){return 0<t.passageNameVisited(r||a())},turns:function(){return t.pastLength}})}();
// end Harlowe Macro Framework


:: CTF 1 {"position":"400,1000","size":"100,100"}
<!--<link rel="stylesheet" href="src/css/ctf1/styles.css">-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.ctf1();
  setup.all();
</script>

<style>
  /* -- Twine overrides -- */

  tw-story {
    background-image: url("src/img/general/ctf/pc_rahmen.png");
    background-size: 110%;
    background-position: center;
    background-repeat: no-repeat;
  }

  tw-sidebar {
    left: -15em;
    width: 15em;
    text-align: left;
  }

  tw-icon {
    left: 3.5em;
  }

  /* -- General CSS -- */

  html {
    overflow-y: hidden !important; /* Disable scroll */
  }

  br {
    display: none;
  }

  .twine-background-login {
    position: inherit;
    background-color: white;
    width: 500px;
  }

  .login-contianer {
    height: 500px;
    margin-left: 30% !important;
    margin-top: -1% !important;
  }

  .headline {
    margin-top: -7rem;
    margin-bottom: 7rem;
  }

  .resumeButton {
    z-index: 1;
    height: 2.5em;
    width: 8em;

    border: none;
    border-radius: 35px;
    background-color: #f79e00;
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);

    font-size: 1em;
    color: #1e1e1e;
    text-decoration: none;
    text-shadow: 2px 2px 4px #000000;
  }

  .buttons {
    display: flex;
    flex-direction: column;
    position: fixed;
    right: 1rem;
    bottom: 1rem;
  }

  .btn-pos1, .btn-pos2, .btn-pos3, .btn-pos4 {
    padding: 0.25rem;
  }
</style>

(set: _info to "Your forgot your password, maybe it is possible to find it, somewhere else.")
(if: $ctfs contains "ctf1")[]
(else:)[(alert: _info)]

<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>

<div class="container login-contianer">
  <form method="GET" action="javascript:void(0);" class="box twine-background-login">
    <div class="field">
      <label class="label">Username</label>
      <div class="control">
        <input class="input" id="user" type="text" placeholder="some name">
      </div>
    </div>
    <div class="field">
      <label class="label">Password</label>
      <div class="control">
        <input class="input" id="password" type="password" placeholder="some password">
      </div>
    </div>
    <button id="login-btn" class="button is-primary">Sign in</button>
  </form>
</div>

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF1end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "What does the JavaScript funktion atob() do?")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "Can you find a method that will be executed when you press the button?")]
  </div>
</div>


:: CTF1end {"position":"600,1000","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf1/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);

        $success = "pscKGbMnGHyRQqNb5EYiLrO+BmlyOtUEpe/z9T84MShKWW6OfWVKNLgpsZO0us+qtm9BCr6Srcg2SGvpleNveg==" == hashed
        var success = "pscKGbMnGHyRQqNb5EYiLrO+BmlyOtUEpe/z9T84MShKWW6OfWVKNLgpsZO0us+qtm9BCr6Srcg2SGvpleNveg==" == hashed

        if(success){
	        document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>

      (if: $success is true)[  
        (alert: "Correct Flag!")  
      (unless: $ctfs contains "ctf1")[
        (set: $ctfs to it + (a: "ctf1"))]]\
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\
      
      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->4.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
      ]\
    ]
  </div>
</div>


:: CTF 10 {"position":"1150,300","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf10/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery.terminal/css/jquery.terminal.min.css"/>

<script>
  setup.all();
</script>

(set: _info to "")

(if: $ctfs contains "ctf10")[]
(else:)[(alert: _info)]

(link-repeat: "What should I do?")[(alert: _info)]
<script src="https://cdnjs.cloudflare.com/ajax/libs/BrowserFS/2.0.0/browserfs.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.terminal/2.34.0/js/jquery.terminal.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/jquery.terminal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/animation.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/less.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/pipe.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/unix_formatting.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.terminal/js/terminal.widget.js"></script>

<tw-consecutive-br></tw-consecutive-br>

<script>
  //https://jvilk.com/browserfs/1.4.1/classes/_backend_localstorage_.localstoragefilesystem.html
  BrowserFS.install(window);

  // Write JavaScript here
  BrowserFS.configure(
  {
    fs: "LocalStorage", // from Backends table below,
    options:
    {}
  }, function(e)
  {
    if (e)
    {
      // An error occurred.
      throw e;
    }

    // Otherwise, you can interact with the configured backends via our Node FS polyfill!
    var fs = BrowserFS.BFSRequire('fs');
    fs.readdir('/', function(e, contents)
    {
      // etc

      fs.writeFile('/test.txt', 'Cool, I can do this in the browser!', function(err) {});

      var current_dir = "/";

      function getCurrentDir()
        {
            if (!String(current_dir).endsWith('/'))
            {
                current_dir += "/";
            }
            return current_dir.toString();
        }

        function setDirDown()
        {
            if (current_dir == "/")
            {
                return current_dir;
            }
            else
            {
                // /home/marc/test
                dirs = getCurrentDir().slice(0, -1).split('/');
                terminal.echo("dirs: " + dirs);
                terminal.echo("current_dir: " + current_dir);
                dirs.pop();
                terminal.echo("dirs: " + dirs);
                current_dir = dirs.join('/');
                terminal.echo("current_dir: " + getCurrentDir());
            }
        }

        terminal = $('terminal').terminal((command) =>
        {
            var cmd = $.terminal.parse_command(command);
            /*terminal.echo(command);*/
            if (commandList[cmd.name])
            {
                commandList[cmd.name].call(terminal, cmd);
            }
            else if (cmd.name.length == 0)
            {
                return;
            }
            else
            {
                terminal.error('Command not found: ' + cmd.name);
            }
        },
        {
            greetings: 'Your PC',
            name: 'js_demo',
            height: 460,
            width: 823,
            prompt: 'root@localhost:' + current_dir + '\$> '
        });

        var commandList = {
            help: function(cmd)
            {
                terminal.echo(Object.keys(commandList).reduce((accumulator, currentValue) => accumulator + "\n" + currentValue, "Available commands:"));
            },
            qq: function(cmd)
            {
                commandList.call(terminal, help)
            },
            add: function(cmd)
            {
                terminal.echo(parseInt(cmd.args[0]) + parseInt(cmd.args[1]));
            },

            sub: function(cmd)
            {
                terminal.echo(parseInt(cmd.args[0]) - parseInt(cmd.args[1]));
            },
            cd: function(cmd)
            {
                if (cmd.args[0] == "..")
                {
                    //Function go back or /
                    //change promt
                    setDirDown();
                    terminal.set_prompt('root@localhost:' + getCurrentDir() + '\$>');
                    return;
                }
                else if (cmd.args[0] == ".")
                {
                    return;
                }
                //Check if dir exists
                if (!fs.existsSync(getCurrentDir() + cmd.args[0]))
                {
                    terminal.echo("Not a directory");
                }
                current_dir = "/" + cmd.args[0];
                terminal.set_prompt('root@localhost:' + getCurrentDir() + '\$>');
            },

            ls: function(cmd)
            {
                /*ls <dir>*/
                fs.readdir(getCurrentDir(), function(err, contents)
                {
                    terminal.echo(contents.toString().split(","));
                });
            },
            touch: function(cmd)
            {
                if (cmd.args.length != 1)
                {
                    printHelp("touch");
                }
                else
                {
                    fs.writeFile(cmd.args[0], '', function(err) {});
                }
            },
            pwd: function(cmd)
            {
                terminal.echo(getCurrentDir());
            },
            mkdir: function(cmd)
            {
                if (cmd.args.length != 1)
                {
                    printHelp("mkdir");
                }
                else
                {
                    fs.mkdir(cmd.args[0], function(err, contents) {});
                }
            },
            less: function(cmd)
            {
                if (cmd.args.length != 1)
                {
                    printHelp("less");
                }
                else
                {
                    //check if exsis
                    if (!fs.existsSync(getCurrentDir() + cmd.args[0]))
                    {
                        terminal.echo("no such file or directory");
                    }
                    fs.readFile(cmd.args[0], function(err, contents)
                    {
                        terminal.echo(contents.toString());
                    });
                }
            },
            startCTF: function(cmd)
            {
                terminal.echo("Welcome to this reverse engineering CTF.");
                terminal.echo("Try to find the CTF and have fun!");
                terminal.echo("");
                //terminal.pause();
                //ctf();
                ctf2(terminal);
            }
        }

        function printHelp(forCommand)
        {
            switch (forCommand)
            {
                case "mkdir":
                    terminal.echo("Usage mkdir <foldername>");
                    break;
                case "less":
                    terminal.echo("Usage less <filename>");
                    break;
                case "touch":
                    terminal.echo("Usage touch <filename>");
                    break;
            }
        }

    });
});

function ctf2(terminal)
{
      const Action = {
        sellOrBuy: 'sellOrBuy',
        SellWhat: 'SellWhat',
        BuyWhat: 'BuyWhat',
        HowMany: 'HowMany',
        Default: 'default'
      };
  
    var next = Action.default;
   
    var money = 100;

    var localInv = []

    var items = {
        // Name Costs Amount
        1:{"costs": 5, "amount": 0},
        2:{"costs": 10, "amount": 0},
        3:{"costs": 500, "amount": 0},
        4:{"costs": 20, "amount": 0},
    };
  
    const itemNames = new Map();

    itemNames.set("1", "first");
    itemNames.set("2", "second");
    itemNames.set("3", "secret");
    itemNames.set("4", "third");


    function getItems()
    {
        return items;
    }

    function getMoney()
    {
        return money;
    }

    function removeMoney(m)
    {
        return money -= m;
    }

    function addMoney(m)
    {
        return money += m;
    }

    function printWhatTodo()
    {
        terminal.echo("What do you what to do");
        terminal.echo("");
        terminal.echo("1: to sell a item");
        terminal.echo("2: to buy a item");
    }

    function sellItem()
    {
        terminal.echo("");
        terminal.echo("");
        terminal.echo("What do you what to sell (only one at the time)");
        terminal.echo("You have:");
        terminal.echo("");
        i = 0;

        terminal.echo("pos\t\tname\t\t\t\tamount");
        for (key of Object.keys(getItems()))
        {
            terminal.echo(i++ + "\t\t" + itemNames.get(key) + "\t\t\t\t" + items[key]['amount'], true);
        }

        terminal.read('', readSwitch, function(err) {})
        next = Action.SellWhat;
    }
  
    function sellOneItem(item){
      items[item]['amount']--;
      removeMoney(items[key]['costs']);
    }

    function sellChooise(i)
    {
        switch (i)
        {
            case "0":
                if (items[0]['amount'] > 0) {
                    sellOneItem(0);
                } else {
                    terminal.echo("You don't have enought to sell");
                }
                break;
            case "1":
                if (items[1]['amount'] > 0) {
                    sellOneItem(1);
                } else {
                    terminal.echo("You don't have enought to sell");
                }
                break;
            case "q":
                return;
            default:
                /*terminal.echo("error reading input");
                terminal.read('', sellChooise(i), function(err) {})*/
                return;
        }

    }



    function printInventory()
    {
        terminal.echo("Your are in a mall and want to buy or sell some items");
        terminal.echo("Your currently have " + getMoney() + " Bitcoins ");
        terminal.echo("You can buy these things");
        terminal.echo("");

        terminal.echo("name\t\t\t\t\tcosts\t\t\t\tamount");
        for (const key of Object.keys(getItems()))
        {    
            terminal.echo(itemNames.get(key) + "\t\t\t\t" + items[key]['costs'] + "\tBitcoins \t\t" + items[key]['amount'], false);
        }
    }

    printInventory();
    terminal.flush();
    terminal.echo("")
    printWhatTodo();

    terminal.read('', readSwitch, function(err) {})
    next = Action.sellOrBuy;

    function sellOrBuy(i)
    {
        switch (i)
        {
            case "1":
                sellItem();
                break;
            case "2":
                terminal.echo("2");
                break;
            default:
                terminal.echo("error reading input");
                terminal.read('', readSwitch, function(err) {})
                return;
        }
    }
  
    function readSwitch(readIn){
      if (next == Action.sellOrBuy){
        sellOrBuy(readIn);
      } if (next == Action.SellWhat){
        sellChooise(readIn);
      } 
    }
}
</script>
<terminal> </terminal>

<button class="reload-btn-background"></button>

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF10end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 2")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 1")]
  </div>
</div>


:: CTF10end {"position":"1150,500","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf10/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);
    
        $success = "04TG3BFjiAp6H8ComHvBfKzf+NYbhRWSOUn49HjgmZb2BcL6ECGqARo6EyOOuRpTVhXItTb5AjTfq+Pildh6fw==" == hashed
        var success = "04TG3BFjiAp6H8ComHvBfKzf+NYbhRWSOUn49HjgmZb2BcL6ECGqARo6EyOOuRpTVhXItTb5AjTfq+Pildh6fw==" == hashed
    
        if(success){
          document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>

      (if: $success is true)[
        (alert: "Correct Flag!")
      (unless: $ctfs contains "ctf10")[(set: $ctfs to it + (a: "ctf10"))]]\
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\

      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->x.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
      ]\
    ]
  </div>
</div>


:: CTF 11 {"position":"1300,300","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf11/styles.css">
<script>
  setup.all();
</script>
(set: _whatToDo to "Seems like some kind of encrypted text")

[(alert: _whatToDo)]

Usg wlees,

qi coh'fm uiaqwvj xhvg, bkin lcc svooojoc fbivg e wnm br hepfgsx tuwa pisfooh trbdmupy.  Ng i uiwnfl kirr'g gryr asfw jlnu: noeg{wvo_125}. Jsoq zcfo fbf bki nrlb flayzmqkef.

key: NoIdea

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF11end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 2")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 1")]
  </div>
</div>


:: CTF11end {"position":"1300,500","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf11/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);
        
        $success = "oGfjoeX7LZskg8IY/OYqMA+lO3j0eXsHWXZ00FuH7dIoWJ4AZgaqBtgnd/dGDLGkOwGEeZLuXCcy8vcODpUrWQ==" == hashed
        var success = "oGfjoeX7LZskg8IY/OYqMA+lO3j0eXsHWXZ00FuH7dIoWJ4AZgaqBtgnd/dGDLGkOwGEeZLuXCcy8vcODpUrWQ==" == hashed
        
        if(success){
          document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>

      (if: $success is true)[
        (alert: "Correct Flag!")
      (unless: $ctfs contains "ctf11")[
        (set: $ctfs to it + (a: "ctf11"))]  ] \
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\
      
      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->x.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
      ]\
    ]
  </div>
</div>


:: CTF 2 {"position":"400,1600","size":"100,100"}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<link rel="stylesheet" href="src/css/ctf2/styles.css">

<script>
  setup.all();
</script>

<h3>Do I live alone? </h3>

Great! Now you know your name, but nothing else.

After the thorough search on the book shelf with little progress, you feel helpless. You take a seat and try to calm your nervs a bit. However, a painting hanging on the wall infront of you keeps garnering your attention. There is something about it you can't put your finger on...

<img src="src/img/ctf2/ctf2.jpg" style="max-width:100%;height:auto;" alt="picture frame"></img>

Maybe taking a closer look at it is not a bad idea.

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF2end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "Do you know what meta data means?")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "A photo is way more that a bunch of colored pixels. The details of a picture can reveal some of its secrets.")]
  </div>
</div>


:: CTF2end {"position":"600,1600","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf2/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);

        $success = "rcwEboA5C46HpiUrGyiDluk5wSjJrUKSrPm3fxvAUAWVZJC8G8OC6W9Q5teUOs2aI/HYomw6mReMu3rkEOP7KQ==" == hashed
        var success = "rcwEboA5C46HpiUrGyiDluk5wSjJrUKSrPm3fxvAUAWVZJC8G8OC6W9Q5teUOs2aI/HYomw6mReMu3rkEOP7KQ==" == hashed
        
        if(success){
          document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>

      (if: $success is true)[  
        (alert: "Correct Flag!")  
      (unless: $ctfs contains "ctf2")[
        (set: $ctfs to it + (a: "ctf2"))]]\
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\
      
      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->7.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
      ]\
    ]
  </div>
</div>


:: CTF 3 {"position":"700,300","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf3/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<script>
  setup.all();
</script>

(set: _whatToDo to "You should be taking a closer look at things...")

[(alert: _whatToDo)]

<title>Challenge</title>

<h1>Capture the Flag</h1>
<!-- TODO: Delete citation -->
<p>Capture the Flag (CTF) in computer security is an exercise in which "flags" are secretly hidden in purposefully-vulnerable programs or websites. It can either be for competitive or educational purposes. Competitors steal flags either from other competitors (attack/defense-style CTFs) or from the organizers (jeopardy-style challenges). Several variations exist. Competitions can including hiding flags in hardware devices, they can be both online or in-person, and can be advanced or entry-level. The game is based on the traditional outdoor sport of the same name.</p>
<p> Source: Wikipedia </p>

<!--flag{12_234_ghuzt5r}-->

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
     [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF3end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 2")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 1")]
  </div>
</div>


:: CTF3end {"position":"700,500","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf3/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
  [
    <script>
      var input = $flag
      var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);

      $success = "kl4L9GzyfPccA7tMeEf+vidocY6v7TXtJGpeNaWAYmXko3QoDAVREopOOEqdba5pjr6IHfrxNcnx95ZyaJNQ4Q==" == hashed
      var success = "kl4L9GzyfPccA7tMeEf+vidocY6v7TXtJGpeNaWAYmXko3QoDAVREopOOEqdba5pjr6IHfrxNcnx95ZyaJNQ4Q==" == hashed
      
      if(success){
        document.getElementById("checkflag_btn").style.display = "none";
      }
    </script>
    
    (if: $success is true)[  
      (alert: "Correct Flag!")  
    (unless: $ctfs contains "ctf3")[
      (set: $ctfs to it + (a: "ctf3"))]  ] \
    (unless: $success is true)[
      (alert: "Incorrect Flag, please try again!")]\
    
    (if: $success is true)[\
      (if: $playingStory is true)[
        [[<button class="resumeButton">Resume Story</a>->x.p]]]\
      (else:)[
        [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
    ]\
  ]
  </div>
</div>


:: CTF 4 {"position":"400,1200","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf4/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.all();
</script>

(set: _info to "Cross-Site Scripting (XSS) is a type of client-side injection attack where a malicious script is injected into a legitimate website and executed. XSS attacks can occur when an attacker try to uses a web application to send malicious code, usually in the form of a browser-side script, to another end user.

Vulnerabilities that enable these attacks are widespread and occur wherever a web application ''uses input from a user within the output it generates without validating or encoding it.''

In this challenge you can try to insert a JavaScript alert() in the frame below. This JavaScript alert() should show up a pop up window.

For this CTF please imagine there is vulnerable Webseite on the Webserver (https://twine.ctf)
It is not necessary to look into the the code. 

Note: If you have injected XSS successfully, you will be redirected automatically.
")

<!-- TODO: Delete comment -->
<!--(if: $onTimeShow is false)
(if: $onTimeShow is true)[ (alert: _info)]
(if: $onTimeShow is true)[ (set: $onTimeShow to false)]-->

(if: $ctfs contains "ctf4")[]
(else:)[(alert: _info)]

<tw-consecutive-br></tw-consecutive-br>

<div class="webbrowser">
  <div id="tab">
    <div class="controls">
      <span class="url label">URL:</span>
      <input id="input" class="urlbar input" type="text" value="https://twine.ctf/ctf4.html">
      <input id="surfbutton" class="button is-success urlbutton" type="Submit" onclick="setup.ctf4_updateFrame()" value="Surf">
    </div>
    <iframe src="src/static/ctf4/s.html" title="Google"></iframe>
  </div>
</div>

<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    (link-repeat: "<button class=\"help-btn-background\"></button>")[(alert: _info)]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "It is possible to pop an alert with javascript \"alert()\", you should only add some script-tags")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "You need to insert some javascript, maybe the script tag helps")]
  </div>
</div>


:: CTF4_end {"position":"600,1200","size":"100,100"}
(unless: $ctfs contains "ctf4")[(set: $ctfs to it + (a: "ctf4"))]
<link rel="stylesheet" href="src/css/ctf4/styles_end.css">

Congratulations you made it!

(if: $playingStory is true)[
  [[<button class="resumeButton">Resume Story</a>->x.p]]]\
(else:)[
  [[Back to CTF-Overview->CTFs]]]


:: CTF 5 {"position":"400,1400","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf5/styles.css"></link>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.all();
</script>

(set: _info to "This time, you should also insert an alert(). Use a special script tag to archive it. It is not necessary to look into the the code.

Note: If you have injected XSS successfully, you will be redirected automatically.")

<!-- TODO: Delete unused code -->
<!--(if: $onTimeShow is false)
(if: $onTimeShow is true)[ (alert: _info)]
(if: $onTimeShow is true)[ (set: $onTimeShow to false)]-->

(if: $ctfs contains "ctf5")[]
(else:)[(alert: _info)]

<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>

<div class="webbrowser">
  <div id="tab">
    <div class="controls">
      <span class="url label">URL:</span>
      <input id="input" class="urlbar input" type="text" value="https://twine.ctf/ctf5.html">
      <input id="surfbutton" class="button is-success urlbutton" type="Submit" onclick="setup.ctf5_updateFrame()" value="Surf">
    </div>
    <iframe src="src/static/ctf5/t.html" title="Google"></iframe>
  </div>
</div>

<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    (link-repeat: "<button class=\"help-btn-background\"></button>")[(alert: _info)]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "Think of an image tag, could you insert same javascript here (onerror= and src=)")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "Maybe there are other html tags that are vulnerable?")]
  </div>
</div>


:: CTF5_end {"position":"600,1400","size":"100,100"}
(unless: $ctfs contains "ctf5")[(set: $ctfs to it + (a: "ctf5"))]
<link rel="stylesheet" href="src/css/ctf5/styles_end.css">

Congratulations you made it!

(if: $playingStory is true)[
  [[<button class="resumeButton">Resume Story</a>->6.p]]]\
(else:)[
  [[Back to CTF-Overview->CTFs]]]


:: CTF 6 {"position":"1000,300","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf6/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css">

(set: $ctf6_code to "
	function showTab(input) {
    var picID;

    if (input.length == 1) {
		  picID = input;
	  } else {
		  picID = input.substring(1, 0);
	  }
	
    var html = \"Image \" + picID + \"<br>\";
    html += \"< img src='../../img/ctf6/\" + input + \".jpg' />\";
    html += \"< /br>\"
    document.getElementById(picID).innerHTML = html;  
    console.log(html)

	  window.localStorage.setItem('picID', input);
	
    var i;
    var x = document.getElementsByClassName(\"animals\");

    for (i = 0; i < x.length; i++) {
      x[i].style.display = \"none\";  
    }

	  document.getElementById(picID).style.display = \"block\";

	  /* Ignore if its just for the Challenge */	
	  parent.postMessage(\"ctf6_url_\" + input, \"*\");
	  return
  }
")

(set: _info to "Try to insert some JavaScript ino this website. This time there is no input

Note: If you have injected XSS successfully, you will be redirected automatically.
")

(if: $ctfs contains "ctf6")[]
(else:)[(alert: _info)]

<script> 
  setup.ctf6_reset()
  setup.all();
</script>

<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>

<div class="webbrowser">
  <div id="tab">
    <div class="controls">
      <span class="url label">URL:</span>
      <input id="input" class="urlbar input" type="text" value="https://twine.ctf/ctf6.html">
      <input id="surfbutton" class="button is-success urlbutton" type="Submit" onclick="setup.ctf6_updateFrame()" value="Surf">
    </div>
    <iframe scrolling="yes" src="src/static/ctf6/u.html" title="Google"></iframe>
  </div>
</div>

<tw-consecutive-br></tw-consecutive-br>
<tw-consecutive-br></tw-consecutive-br>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>

<div class="buttons">
  <div class="btn-pos5">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos4">
    (link-repeat: "<button class=\"code-btn-background\"></button>")[(alert: "
      <pre>
      <code id=\"code\" class=\"language-javascript\"></code>
      </pre>

      <script>
        setup.ctf6_showCode();
        hljs.highlightAll();
      </script>")]
  </div>
  <div class="btn-pos3">
    (link-repeat: "<button class=\"help-btn-background\"></button>")[(alert: _info)]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "You can use the URL Hash-Paramter to inject some JavaScript. Remember it used for building a image")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "There is no input textbox for XSS Injection, but can you use something else")]
  </div>
</div>


:: CTF6_end {"position":"1000,500","size":"100,100"}
(unless: $ctfs contains "ctf6")[(set: $ctfs to it + (a: "ctf6"))]
<link rel="stylesheet" href="src/css/ctf6/styles_end.css">

<script>
  setup.ctf6_reset()
</script>

Congratulations you made it!

(if: $playingStory is true)[
  [[<button class="resumeButton">Resume Story</a>->x.p]]]\
(else:)[
  [[Back to CTF-Overview->CTFs]]]


:: CTF 7 {"position":"400,800","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf7/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.all();
</script>

<h1>Who even am I?</h1>

<img src="src/img/ctf7/books-shelf.jpg"></img>

Right behind the entrance you find you find big shelfs full of leaflets and local advertisements. According to activist friends the search warrants for you are spread everywhere. So, you’re bound to find some of them here. You start looking around those shelfs desperate for information. 

[[<button class="button is-danger is-rounded" style="background-color: var(--purple);">First Shelf->First Shelf]]

[[<button class="button is-danger is-rounded" style="background-color: var(--purple);">Second Shelf->Second Shelf]]

[[<button class="button is-danger is-rounded" style="background-color: var(--purple);">Third Shelf->Third Shelf]]

[[<button class="button is-danger is-rounded" style="background-color: var(--purple);">Fourth Shelf->Fourth Shelf]]

[[<button class="button is-danger is-rounded" style="background-color: var(--purple);">Fifth Shelf->Fifth Shelf]]

<!--1st Part: puzzelPiece{John-->

A search on the surface level is not enough. Further inspection is needed. 

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF7end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 2")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "Open your inspector view and have a look at the website’s resources.")]
  </div>
</div>


:: First Shelf {"position":"800,800","size":"100,100"}
Nothing really useful here


:: Second Shelf {"position":"925,800","size":"100,100"}
No useful information here...


:: Third Shelf {"position":"1050,800","size":"100,100"}
Nothing here either...


:: Fourth Shelf {"position":"1175,800","size":"100,100"}
This search has lead me nowhere so far..


:: Fifth Shelf {"position":"1300,800","size":"100,100"}
Yup... I did all of that for nothing :(


:: CTF7end {"position":"600,800","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf7/styles_end.css">

Please enter the flag here: 
(set: $success to false)
<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);

        $success = "CyqsWI62MyCkM/G/gq8DL/UlABLfRz+EujUfmutb0fjn1xILAIGIKd+fvQSHQbrV/JtTucxz9dvvynNvuZoz5w==" == hashed
        var success = "CyqsWI62MyCkM/G/gq8DL/UlABLfRz+EujUfmutb0fjn1xILAIGIKd+fvQSHQbrV/JtTucxz9dvvynNvuZoz5w==" == hashed
        
        if(success){
          document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>
    
      (if: $success is true)[  
        (alert: "Correct Flag!")  
      (unless: $ctfs contains "ctf7")[
        (set: $ctfs to it + (a: "ctf7"))]]\
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\

      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->3.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
      ]\
    ]
  </div>
</div>


:: CTF 8 {"position":"850,300","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf8/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.all();
</script>

<style>
  body {
    text-align: center;
  }
</style>

<title>Center align button</title> <!-- TODO: Title is not visible -->

Download the file and check for valuable information. 
There might be something more to it than what you first see...

<button type="submit" onclick="window.open('src/static/ctf8/my_office.jpg')">Download</button>

<div class="buttons">
  <div class="btn-pos4">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos3">
    [[<button class="success-btn-background"></button>->CTF8end]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 2")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "HINT 1")]
  </div>
</div>


:: CTF8end {"position":"850,500","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf8/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);
        
        $success = "0ADZFsuSMa/2DSyhcvnbDHkfODi69oSp84/hw4XHntCKGk+NdQyyJ8aLzOnU8qWRzIlhLtPPvX8LRaHj/FERXg==" == hashed
        var success = "0ADZFsuSMa/2DSyhcvnbDHkfODi69oSp84/hw4XHntCKGk+NdQyyJ8aLzOnU8qWRzIlhLtPPvX8LRaHj/FERXg==" == hashed
        
        if(success){
          document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>

      (if: $success is true)[
        (alert: "Correct Flag!")  
      (unless: $ctfs contains "ctf8")[
        (set: $ctfs to it + (a: "ctf8"))]]\
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\

      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->x.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
      ]\
    ]
  </div>
</div>


:: CTF 9 {"position":"400,2200","size":"100,100"}
<link rel="stylesheet" href="src/css/ctf9/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>

<script>
  setup.all();
</script>

<h1>A random file in your home directory</h1>

Within the chaos on your personal drive you find a file that doesn’t seem very bad to start with. It seems like it used to hold some secretive information, but someone tried to mess it up. Luckily you’re an expert on reverse engineering. This should be an easy task for you. 

(set: $ctf9_code to "
  public class ctf9 {
    static char [] theSecret;
    public static void encryptSecret() {
      theSecret = new char [14];
      theSecret [3] = 'n';
      theSecret [4] = 'o';
      theSecret [0] = 'B';
      theSecret [7] = 'l';
      theSecret [2] = 'u';
      theSecret [8] = 'l';
      theSecret [10] = 'd';
      theSecret [12] = 'e';
      theSecret [13] = 'r';
      theSecret [11] = 'H';
      theSecret [1] = 'r';
      theSecret [9] = 'e';
      theSecret [5] = 'K';
      theSecret [6] = 'i';
    }

    public static String conclusion() {
      String conc = \"This case is unsolvable. Give up!\";
       return  conc;
    }

    public static void main(String[] args) {
      System.out.println(conclusion());
    }
  }
")

<!-- TODO: No highlighting in code -->
<!-- TODO: Button on wrong position -->
<div>
  (link-repeat: "<button class=\"code-btn-background\"></button>")[
    (alert: "
      <pre>
        <code id=\"code\" class=\"language-java scrollbar\"></code>
      </pre>

      <script>
        setup.ctf9_showCode();
        hljs.highlightAll();
      </script>")]
</div>

<div class="buttons">
  <div class="btn-pos5">
  	(if: $playingStory is true)[
      [[<button class='home-btn-background'></button>->MainPage]]]
        (else:)[
      [[<button class='home-btn-background'></button>->CTFs]]]
  </div>
  <div class="btn-pos4">
    [[<button class="success-btn-background"></button>->CTF9end]]
  </div>
  <div class="btn-pos3">
    [[<button class="code-btn-background"></button>->MainPage]]
  </div>
  <div class="btn-pos2">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "Have you tried working with char arrays in java?")]
  </div>
  <div class="btn-pos1">
    (link-repeat: "<button class=\"hint-btn-background\"></button>")[(alert: "The main method may be misleading. When you find the flag, enter it in the following format: puzzelPiece&lbrace;enterFlagHere&rbrace;.")]
  </div>
</div>


:: CTF9end {"position":"600,2200","size":"100,100"}
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.js"></script>
<link rel="stylesheet" href="src/css/ctf9/styles_end.css">

Please enter the flag here: 
(set: $success to false)

<div class="container">
  <div>(input-box: bind $flag, "XXX=", 5)[]</div>
  <div>(link-repeat: "<button id='checkflag_btn' class='color_purple checkFlagButton'>Check Flag</button>")
    [
      <script>
        var input = $flag
        var hashed = CryptoJS.SHA512(input).toString(CryptoJS.enc.Base64);
        
        $success = "j4EpWA5Ylg2qTpLwOV0eLVynMPc7Fz7YnywKDW2rTB+/i6mz7aHC+NErVJzjV2t6DBcrne3DnakwM+1Hru2+pA==" == hashed
        var success = "j4EpWA5Ylg2qTpLwOV0eLVynMPc7Fz7YnywKDW2rTB+/i6mz7aHC+NErVJzjV2t6DBcrne3DnakwM+1Hru2+pA==" == hashed
        
        if(success){
          document.getElementById("checkflag_btn").style.display = "none";
        }
      </script>
    
      (if: $success is true)[
        (alert: "Correct Flag!")  
      (unless: $ctfs contains "ctf9")[
        (set: $ctfs to it + (a: "ctf9"))]]\
      (unless: $success is true)[
        (alert: "Incorrect Flag, please try again!")]\
      
      (if: $success is true)[\
        (if: $playingStory is true)[
          [[<button class="resumeButton">Resume Story</a>->10.p]]]\
        (else:)[
          [[<button class="resumeButton">Back to CTF-Overview->CTFs]]]\
    ]\
    ]
  </div>
</div>


:: CTFs {"position":"500,200","size":"100,100"}
<link rel="stylesheet" href="src/css/ctfs/styles.css">
(set: $playingStory to false)

(set: _notStarted to "CTF not started yet") \
(set: _started to "Started but not finished") \
(set: _finished to "CTF finished :>")\
(set: _names to (dm: 1, "CTF 1 - XSS", 2, "CTF 2 - Forensics", 3, "CTF 3 - Forensics", 4, "CTF 4 - XSS", 5, "CTF 5 - XSS", 6, "CTF 6 - XSS", 7, "CTF 7 - Web Exploitation" , 8, "CTF 8 - Forensics", 9, "CTF 9 - Reverse Engineering", 10, "CTF 10 - Reverse Engineering", 11, "CTF 11 - Cryptography") )\
(set: _difficulties to (dm: 1, "1", 2, "1", 3, "0", 4, "2", 5, "3", 6, "3", 7, "1", 8, "0", 9, "1", 10, "0", 11, "0") )\

<header>
  <div class="logo">
    <img src="src/img/header/logo.svg" alt="logo">
  </div>
  <nav>
    <ul>
      <li>
        [[<a>Home</a>->MainPage]]
      </li>
      <li class="active">
        [[<a>CTFs</a>->CTFs]]
      </li>
      <li>
        [[<a>Tutorial</a>->Tutorial]]
      </li>
    </ul>
  </nav>
</header>

<section>
  Here you can find an overview of all CTF challenges. Feel free to browse through them and jump straight to your favorite challenge without having to go through the story mode.


  (if: $ctfs's length is 0)[\
      No ctf has been completed so far.
  ](else:)[\
      <!-- we iterate over the array and print each item -->\
      (for: each _item, ...$ctfs)[\
          _item (unless: $ctfs's last is _item)[, ]\
      ].
  ]

  (for: each _i, ...(range:1,11))[
  (print: '<div class="ctfpos ctf' + (text: _i) + '">')
    <div class='rectangle'> 
      <div class='box_img'> 
        <img src='src/img/main/previews/preview_default.svg' alt='preview'> 
      </div> 
      <div class='box_text'> 
        <ul> 
          <li> 
          (print: _names's (_i))
          </li> 
          <li>
            Difficulty level: (print: _difficulties's (_i))
          </li> 
          <li> 
            State: (if: $ctfs contains "ctf" + (text: _i) )[(print: _finished)](else:)[(if: (history:) contains "CTF " + (text: _i))[(print: _started)] (else:)[(print: _notStarted)]] 
          </li> 
        </ul> 
      </div>  
      <div class='box_button'> 
        (print: '[[<button class="startButton">Start->CTF ' + (text: _i) + ']]')
      </div> 
    </div> 
  ]

</section>


:: initMain {"position":"100,0","size":"100,100"}
<!--only for init-->

<!-- :: init [startup] -->
<!-- it is always a good idea to initialize your variables, but with arrays it is particularly important -->


(set: $playingStory to false)
<!--0  dann keine Story, wenn 1 dann Story-->

(set: $ctfs to (a:))

(go-to: "MainPage")


:: MainPage {"position":"200,200","size":"100,100"}
<link rel="stylesheet" href="src/css/main/styles.css">

<header>
  <div class="logo">
    <img src="src/img/header/logo.svg" alt="logo">
  </div>
  <nav>
    <ul>
      <li class="active">
        [[<a>Home</a>->MainPage]]
      </li>
      <li>
        [[<a>CTFs</a>->CTFs]]
      </li>
      <li>
        [[<a>Tutorial</a>->Tutorial]]
      </li>
    </ul>
  </nav>
</header>

<script>
  setup.main();
</script>

<section>
  <div class="usb-stick" id="demo">
    <img src="src/img/main/usb_stick.svg" alt="usb-stick">
  </div>
  <div class="preview">
    <div class="preview_bg">
      <img src="src/img/main/previews/preview_default.svg" alt="preview">
      <div class="rectangle">
        <button id="startButton" class="startButton">Start</a>
		    <button id="restartButton" class="restartButton">Restart</a>
      </div>
  </div>
</section>


:: setStory {"position":"200,350","size":"100,100"}
(set: $playingStory to true)
<script>
  var nextPage = Harlowe.storage.load('last_passage');

  if (nextPage == null){
    nextPage = "Story";
  }
  
  Harlowe.goto(nextPage);
</script>


:: Achievements {"position":"300,0","size":"100,100"}


:: Settings {"position":"500,0","size":"100,100"}


:: Story {"position":"200,400","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()

  var sidebar = document.querySelector("tw-sidebar");
  var notes = sidebar.childNodes;

  for (let i = 0; i < notes.length; i++) {
	if (notes[i].getAttribute("title") == "Undo") {
	  notes[i].style = "visibility: hidden;";
	}
  }
</script>

You just woke up from what it feels like a decade long nap. You look around to find yourself in an unrecognizable place. You start freaking out...

Some strangers hear you fussing around. They enter the room where you are lying. “Don’t worry. You’re in a safe place.” They interduce themselves as a group of activists. A couple of months ago, they found you unconscious on the side of a street and decided to help you. They recognized you from the search warrant spread all over the city. “A sketchy group has been looking for you intensely.” 

[[<button id="resume-btn" class="button is-danger is-rounded">next->1.p]]


:: 1.p {"position":"200,600","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

To protect you, they took you to their headquarters, took care of you and kept you a secret to ensure your safety. 

“I don’t seem to remember anything. Who even am I?”
To your surprise they respond, “we don’t know. We couldn’t find out who you are.”
However, what they know for sure is that he might be in a great danger. 
You’re tiered. You feel helpless and lost. But you can’t just sit there a do nothing about it. There is a fire burning inside of you. A strong feeling telling you to hurry up. So, you muster every single ounce of energy left inside of you and get up. 
“Thank you for your kindness. But I need to go.” is what you tell the activists before starting your journey to uncover your past and save your future
[[<button id="resume-btn" class="button is-danger is-rounded">next->2.p]]


:: 2.p {"position":"200,800","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

After wondering the streets for a while, you spot a big library at the end of the street. A library seems like a good place to start you search. Over there, you can have access to many resources that will help you with your search. So, to the library you head. 

[[<button id="resume-btn" class="button is-danger is-rounded">Start Challange->CTF 7]]


:: 3.p {"position":"200,1000","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

<h1>Wait... but how can I log in to my account?</h1>

Finding your name is a great start. But you need to learn more about yourself. So, you decide to log on to a computer and research more on the internet. It appears you already have an account at the library. You just need to find a way to enter it.

[[<button id="resume-btn" class="button is-danger is-rounded">Start Challange->CTF 1]]


:: 4.p {"position":"200,1200","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

<h1>Let the search begin!</h1>

You’re in! Naturally the first thing you want to do is to navigate to the web browser and start your search. However, this web browser is behaving weirdly. Whenever you type in your name it doesn’t give you any useful results. "Maybe the bad guy’s looking for me have restricted the search.”
You may have forgot a lot, but you haven’t lost your computer skills. But you know how to crack it.

[[<button id="resume-btn" class="button is-danger is-rounded">Start Challange->CTF 4]]


:: 5.p {"position":"200,1400","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

<h1>I just wanna go home...  </h1>

It has been a long day and this search is taking a toll on you. You just want to go home. Now that you hacked the browser and you know you log-in data, you decide to log into your account and find out more personal information about yourself. Especially your home address. Unfortunately, it seems like the bad guys knew that you're going to do that at some point. So, they somehow gained access to your account and ruined the search function. You have no other choice but to use you XSS skills and and see what information you can retrieve. 

[[<button id="resume-btn" class="button is-danger is-rounded">next->CTF 5]]


:: 6.p {"position":"200,1600","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

Finally! You opened your account and found some information about yourself. You’re done for the day it's time to go home. Before leaving the library, you take a map of your city. You mark your route home. Lucky you! It's not a long distance. So, you walk your way back home. 

You stand in front of the building where you live and you at once recognize it. You inter the building looking for your apartment feeling extremely uneasy. Since you arrived your heart is beating extremely fast. 
 
You know something important that changed your life forever happened here, but you can't remember it. 

You end up finding your apartment in the first floor. The door is open! It seems like a tornado just went by and completely messed up the place. “It must be the bad guys who are looking for me” you say to yourself. However, its already late at night. No time to explore around now. You need to rest. Tomorrow you can start exploring around the place.

[[<button id="resume-btn" class="button is-danger is-rounded">next->CTF 2]]


:: 7.p {"position":"200,1800","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

Now, it all coming back to you. It was a gift from your girlfriend. She drew it for you herself. The moment this memory awakens in your brain, deep grieve starts filling your heart. What happened to her. Where is she??

(Continuation of the girlfriend tragedy here maybe?)

[[<button id="resume-btn" class="button is-danger is-rounded">next->8.p]]


:: 8.p {"position":"200,2000","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

Under the ruins in your office, you find your PC. It seems like someone smashed it with a hammer. Not much of it can be salvaged. But this is not going to make you give up. You’re desperate for finding any thing that will help you remember. Your personal computer is definitely a very important piece of evidence for your search. Your pry the case of your PC open and start looking for the hard disk hoping that you can still save it. To your surprise it doesn’t look in a bad shape. You dismantle it from the ruined parts and decide to go to your activist friends for help. 

[[<button id="resume-btn" class="button is-danger is-rounded">next->9.p]]


:: 9.p {"position":"200,2200","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

“I'm sure they have the tools that will help me extract some information out of it.”
You arrive at the headquarters hectic and stressed out. Your mood immediately changes after seeing everybody there so happy to see you again. They were worried something bad might have happened to you. You assure them that your find, but your search is far away from being done. You pull out the hard disk from your pocket and ask them if they can provide you with some equipment. And they did not disappoint. 
After some fiddling around you manage to connect the drive to a new computer. And voila! You’re in. However, from now on, things start going south. Your disk has been tampered with. Some files are incomplete. Others are encrypted or corrupted.  Extracting information form it is not going to be an easy task. 

[[<button id="resume-btn" class="button is-danger is-rounded">Start Challange ->CTF 9]]


:: 10.p {"position":"200,2400","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">

<script>
  setup.story()
</script>

Coming soon. Stay tuned!

[[<button id="resume-btn" class="button is-danger is-rounded">Back to the main page->MainPage]]


:: x.p {"position":"400,600","size":"100,100"}
<link rel="stylesheet" href="src/css/story/styles.css">

<script>
  setup.story()
</script>

Sorry, these CTFs haven't been implemented in the story yet...

Please come back later!


:: Tutorial {"position":"0,300","size":"100,100"}
<link rel="stylesheet" href="src/css/tutorial/styles.css">

<header>
  <div class="logo">
    <img src="src/img/header/logo.svg" alt="logo">
  </div>
  <nav>
    <ul>
      <li>
        [[<a>Home</a>->MainPage]]
      </li>
      <li>
        [[<a>CTFs</a>->CTFs]]
      </li>
      <li class="active">
        [[<a>Tutorial</a>->Tutorial]]
      </li>
    </ul>
  </nav>
</header>

<section>
  <h2>Tutorial</h2>
  <!-- Introduction to the game -->
  Welcome to the game "Memory Loss: Find Your Way Back". 
  This game is about using capture-the-flag challenges to teach the concepts 
  of IT security by learning attack techniques. Only when the various attack 
  techniques used by hackers to penetrate IT systems are known can the 
  appropriate countermeasures be taken.

  <tw-consecutive-br></tw-consecutive-br>

  <h3>What is a CTF challenge?</h3>
  In IT security, a capture-the-flag (ctf) challenge means hacking into a system to 
  find a flag. This flag is usually a file or a string and can look like this: 
  &lt!-- flag: hur32782ruhu -->.

  In this game, the flags look like this:
  puzzlePiece{<Some hash>}

  Besides that, it is good to know that there are different categories of 
  challenges. A few examples are XSS, Web Exploitation or Cryptography. 

  <tw-consecutive-br></tw-consecutive-br>

  <h3>Modes</h3>
  <!-- Explain both modes: story and ctf -->
  The game is structured in such a way that the challenges are built into a story. This means that in 
  places the challenges are built into the story that must be overcome in order for the story to continue. 

  However, it is possible to play the challenges without the story. To do this, click on "CTFs" in the menu.

  When exiting the story mode, the game state is temporarily saved. The score can be reset on the main 
  page by pressing the "Reset" button.

  <tw-consecutive-br></tw-consecutive-br>

  <h3>How to play the challenges</h3>
  <!-- CTF example, buttons, and flag page -->
  To solve the challenges, a few common approaches are examining source code, tricking inputs or 
  even using Google.

  The following buttons can be found in the challenges to support you:

  <div class="buttons">
    <div class="btn-pos6">
      <button class='home-btn-background'></button>
      <p>Returns to ctf overview or main page depending on the game mode</p>
    </div>
    <div class="btn-pos5">
      <button class='success-btn-background'></button>
      <p>Forwarding to flag check</p>
    </div>
    <div class="btn-pos4">
      <button class='reload-btn-background'></button>
      <p>Reloads the page</p>
    </div>
    <div class="btn-pos3">
      <button class='code-btn-background'></button>
      <p>Shows a code snippet</p>
    </div>
    <div class="btn-pos2">
      <button class='help-btn-background'></button>
      <p>Gives help</p>
    </div>
    <div class="btn-pos1">
      <button class='hint-btn-background'></button>
      <p>Gives a hint</p>
    </div>
  </div>

  A little tip before you start solving the challenge:
  It often makes sense to use the developer mode of the browser. If this 
  doesn't mean anything to you, Google can help.

  <tw-consecutive-br></tw-consecutive-br>
</section>

<style>
  /* -- General CSS -- */

  @import url("https://fonts.cdnfonts.com/css/ocr-a-extended");

  /* -- Twine overrides -- */

  tw-story {
    width: 100%;
    padding: 0;
    background-image: url("src/img/header/header_element.svg"),
      url("src/img/general/background/background_landscape.svg");
    background-repeat: no-repeat, no-repeat;
    background-size: 100%, cover;
    background-attachment: local, fixed;
    box-sizing: border-box;
  }

  tw-consecutive-br {
    display: none;
    visibility: hidden;
  }

  tw-sidebar {
    display: none;
  }

  br {
    display: none;
  }

  /* -- General CSS -- */

  html {
    overflow-y: hidden !important;
  }

  * {
    font-family: "OCR A Extended", sans-serif;
    color: #9b9b9b;
  }

  header {
    height: 25vh;
    display: flex;
  }

  header .logo img {
    height: 4em;
    margin: 2em;
    filter: drop-shadow(7px 7px 5px #000000);
  }

  nav ul {
    margin-left: 6em;
    margin-top: 3em;
    list-style: none;
    display: flex;
    justify-content: space-between;
    flex-direction: row;
  }

  nav li {
    padding: 0 4rem 0 1rem;
  }

  nav li a {
    padding: 5rem;
    font-size: 2rem;
    color: #9b9b9b;
    text-decoration: none;
    text-shadow: 4px 4px 5px #000000;
  }

  nav .active a {
    color: #f79e00;
    text-decoration: none;
    text-shadow: 4px 4px 5px #000000;
  }

  section {
    height: 70vh;
    margin: 0 2em 0 2em;
    overflow-y: scroll; 
  }

  .buttons {
    display: flex-inline;
    flex-direction: column;
  }

  .btn-pos1, .btn-pos2, .btn-pos3, .btn-pos4, .btn-pos5, .btn-pos6 {
    display: flex;
    flex-direction: row;
    justify-content: start;
    align-items: center;
  }

  .buttons p {
    padding-left: 1rem;
  }
</style>


